# Облачная функция для заполнения документов в формате word

Функция предназначена для окружения Yandex Cloud. После запуска index.handler функции будут сгенерированы и высланы на указанную почту документы, заполненные по шаблону.

Функция предназначена для интеграции с Yandex Forms - запуск api с передачей всех ответов в текстовом формате.

Шаблонные файлы должны находится в директории `templates/*.docx`. При подготовке файлов шабонов учитывайте создаваемые скрытые файлы, они могут привести к ошибочному завершению функции.

## Принцип формирования названия полей

Поля формируются по следующему шаблону: `<НАЗВАНИЕ ПОЛЕ ЗАГЛАВНЫМИ БУКВАМИ>`. Данные названия следует указывать в файлах шаблонов.

Пример:
| Ф.И.О. родителя (опекуна) | <Ф.И.О. РОДИТЕЛЯ (ОПЕКУНА)> |
| -- | -- |
| Дата рождения родителя (опекуна) | <ДАТА РОЖДЕНИЯ РОДИТЕЛЯ (ОПЕКУНА)> |
| Почта | <ПОЧТА> |

## Переменные окружения для запуска функции

* `MAIL_TO_FORM_KEY` - Название поля (после преобразования), в котором содержится почта пользователя для отправки ответного письма
* `MAIL_FROM_ALIAS` - Синоним имени пользователя, от имени которого будет выслано письмо
* `MAIL_FROM_MAIL` - Электронная почта автора письма
* `MAIL_SUBJECT` - Тема письма
* `MAIL_TEXT` - Сообщение письма
* `SMTP_ADDRESS` - Адрес почтового сервера
* `SMTP_PORT` - Порт почтового сервера
* `SMTP_LOGIN` - Логин пользователя почты
* `SMTP_PASSWORD` - Пароль пользователя почты

## Тестирование

Для тестирования следует запустить сценарий тестирования `eval $(tr "\n" "\t" < env) python main.py`.

## Подготовка фукнкции для запуска в облаке

Подготовка функции выполняется при помощи сценария `./zipit.sh` в результате получится файл `version-<текущая дата и время>.zip`.