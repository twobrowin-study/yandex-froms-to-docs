# Облачная функция для заполнения документов в формате word

Функция предназначена для окружения Yandex Cloud. После запуска index.handler функции будут сгенерированы и высланы на указанную почту документы, заполненные по шаблонам в формате `docx` и хранимые в директории `templates`.

Функция предназначена для интеграции с Yandex Forms - запуск функции должен выполнятся при помощи интеграции с облачными функциями (новый интерфейс).

Шаблонные файлы должны находится в директории `templates/*.docx`. При подготовке файлов шабонов учитывайте создаваемые скрытые файлы, они могут привести к ошибочному завершению функции.

## Шаблоны

Шаблон должен заполняться запросами на подстановку в стиле Jinja2. Например, в подстановку `{{ parent_name }}` будет подставлено значение имени родителя.

При этом, реальный рендеринг Jinja2 не выполняется, происходить наивная подстановка.

Соответствие названий полей шаблонам устаналивается в сервисе Yandex Forms путём указания соотсветствующих уникальных идентификаторов.

В файле `substitute.yaml` перечислен ряд Jija2 шаблонов, которые используются для подставновки в шаблонах и при этом являются вычисляемыми, а также требуемыми для выслки письма с заполненными документами.

## Подготовка к запуску

Для запуска программы следует скопировать файл `.env.example` в `.env` или задать переменные окружения из этого файла.

## Тестирование

Для тестирования следует запустить сценарий тестирования `python test.py`.

В тестировании используется `test-body.json` - тестовый запрос Yandex Forms.

## Подготовка фукнкции для запуска в облаке

Подготовка функции выполняется при помощи сценария `./zipit.sh` в результате получится файл `version-<текущая дата и время>.zip`.